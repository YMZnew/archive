<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>ARnft example showing an simple red cube</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=1">
	<link rel="stylesheet" href="nft-style.css">
	<p id="date" style="position: absolute;z-index:999"></p>
</head>
<body>

	<audio id="myAudio">
  <source src="chamran.mp3" type="audio/mpeg">
</audio>
	
	
		<script src="three.min.js"></script>
		<script src="ARnft.js"></script>
        <script type='text/javascript' src='Tween.js'></script>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             

    <script>
      
      let ps5
      let prize
      let flag = true

    var current	= { rotation: 0 , scale : 0 };
	    var currentPS5 = {rotation: 0 , scale : 0}
    var update	= function(){
		prize.rotation.y = current.rotation;
	}
    
    var updatePS5 = function(){
	    ps5.rotation.y = currentPS5.rotation;
	    ps5.scale.set(currentPS5.scale,currentPS5.scale,currentPS5.scale);
    }

    var easing	= TWEEN.Easing.Linear.None;
	    var ps5Easing = TWEEN.Easing.Back.Out;

    	var tweenBox	= new TWEEN.Tween(current)
		.to({rotation: 1080,scale :0.5}, 5000)
		.delay(10)
		.easing(ps5Easing)
		.onUpdate(update);
	    
	var tweenPS5 = new TWEEN.Tween(currentPS5)
		.to({rotation: 1080,scale :24}, 10000)
		.delay(10)
		.easing(ps5Easing)
		.onUpdate(updatePS5);

		// tween1 = new TWEEN.Tween( target1.dataset )
		// 				.to( { rotation: 360, y: 300 }, 750 )
		// 				.repeat( 1 )
		// 				.delay( 1000 )
		// 				.yoyo( true )
		// 				.easing( TWEEN.Easing.Cubic.InOut )
		// 				.onUpdate( function() {
		// 					updateBox( target1, this );
		// 				})





			ARnft.ARnft.init(800, 600, "archive/DataNFT/notebook", 'config3.json', true, true)
			.then((nft) => {
				document.addEventListener('onInitThreejsRendering', (ev) => {
					const renderer = ev.detail.renderer;
					const scene = ev.detail.scene;
					const camera = ev.detail.camera;
					
  					renderer.outputEncoding = THREE.sRGBEncoding;
                                        renderer.textureEncoding = THREE.sRGBEncoding
					renderer.physicallyCorrectLights = true;
				
					const light1  = new THREE.AmbientLight(0xFFFFFF, 0.3);
					    light1.name = 'ambient_light';
					    camera.add( light1 );

					let directionalLight = new THREE.DirectionalLight(0xFFFFFF, 0.8 * Math.PI);
					directionalLight.position.set(0.5, 0, 0.866);
					camera.add(directionalLight);
	
					nft.addSimpleModel('./ps5.glb' , 70 , 100 ,0, 24 , function(model){
						try{
						prize = model;
							prize.rotation.x = (Math.PI /2)
							nft.tickExtend = function(){
							try{
								console.log("YMZ-ROTATION call update");
								date = document.getElementById("date");
								date.innerHTML = "rotation : "+ current.rotation;
								TWEEN.update();
								prize.rotation.y = (current.rotation* 0.05)
								prize.scale.set(current.scale,current.scale,current.scale );
							}catch(e){
								alert(e)
							}
								
						}
							
						}catch(e){
							alert(e);
						}
					});
					
					
				})
				
			
				document.addEventListener('getMatrixGL_RH', (ev) => {
					try{
							console.log("YMZ-ROTATION START");
						if(flag){
							flag = false
						tweenBox.start()
							
						}
					}catch(e){
						alert(e)
					}
				});
            });

    </script>
</body>

</html>
